-- List all information about the films, actors, and directors
SELECT m.name, m.premiere_city, m.genre, m.country_of_origin, m.production_company, 
       f.first_week_earnings, f.premiere_format, 
       a.first_name AS actor_first_name, a.last_name AS actor_last_name, 
       d.first_name AS director_first_name, d.last_name AS director_last_name
FROM Movies m
JOIN Films f ON m.movie_id = f.film_id
JOIN Movies_Actors ma ON m.movie_id = ma.movie_id
JOIN Actors a ON ma.actor_id = a.actor_id
JOIN Films_Directors fd ON f.film_id = fd.film_id
JOIN Directors d ON fd.director_id = d.director_id
ORDER BY d.last_name, d.first_name;

-- List actors with lower-than-average grade given by critics
SELECT a.first_name, a.last_name, a.nickname, a.date_of_birth, a.agent_code,
       AVG((ac.grade_acting + ac.grade_expression + ac.grade_naturalness + ac.grade_devotion) / 4) AS avg_grade
FROM Actors a
JOIN Actors_Critics ac ON a.actor_id = ac.actor_id
GROUP BY a.actor_id
HAVING avg_grade < (SELECT AVG((grade_acting + grade_expression + grade_naturalness + grade_devotion) / 4) FROM Actors_Critics)
ORDER BY avg_grade DESC;

-- List Oscar winners older than the average age of all actors
SELECT o.actor_id, a.first_name, a.last_name, a.nickname, a.date_of_birth, a.agent_code, 
       m.name AS movie_name, o.role, o.year,
       TIMESTAMPDIFF(YEAR, a.date_of_birth, CURDATE()) AS age
FROM OscarWinners o
JOIN Actors a ON o.actor_id = a.actor_id
JOIN Films f ON o.film_id = f.film_id
JOIN Movies m ON f.film_id = m.movie_id
WHERE TIMESTAMPDIFF(YEAR, a.date_of_birth, CURDATE()) > 
      (SELECT AVG(TIMESTAMPDIFF(YEAR, date_of_birth, CURDATE())) FROM Actors);